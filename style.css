:root{
  --bg:#0f172a; --card:#1e293b; --text:#e2e8f0;
  --muted:#94a3b8; --accent-blue:#3b82f6; --accent-green:#22c55e;
  --radius:16px; --shadow:0 6px 16px rgba(0,0,0,.35);
}

body{
  margin:0; font-family:"Noto Sans KR", system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Malgun Gothic", Arial, sans-serif;
  background:var(--bg); color:var(--text);
  display:flex; flex-direction:column; min-height:100vh;
}

.topbar{ text-align:center; padding:24px 0; }
.topbar h1{ margin:0; font-size:26px; font-weight:700; }
.topbar .subtitle{ margin:6px 0 0; color:var(--muted); font-size:14px; }

#quiz{ max-width:820px; margin:0 auto; padding:20px; flex:1; }

/* 파일 선택 */
.controls{ text-align:center; margin:20px 0; }
.file-label{
  background:var(--card); padding:12px 20px;
  border-radius:var(--radius); cursor:pointer;
  border:1px solid #334155; font-size:15px;
}
.file-label:hover{ border-color:var(--accent-blue); }
.file-label input{ display:none; }

/* 버튼 공통 */
.btn-green, .btn-blue, .btn-ghost{
  padding:12px 20px; border:none; border-radius:10px;
  font-size:16px; font-weight:600; cursor:pointer; color:#fff;
}
.btn-green{ background:var(--accent-green); }
.btn-blue{ background:var(--accent-blue); }
.btn-green:hover, .btn-blue:hover{ filter:brightness(1.1); }

.btn-ghost{
  background:transparent; color:var(--text);
  border:1px solid #3a4a63;
}
.btn-ghost:hover{ border-color:var(--accent-blue); }

/* 시작 화면 */
.start-screen{ text-align:center; margin-top:40px; }

/* 카드(문제 영역) – 고정 높이 최적화 */
.card{
  background:var(--card); border-radius:var(--radius);
  box-shadow:var(--shadow); padding:40px; margin-top:30px;
  max-width:760px; margin-left:auto; margin-right:auto;

  /* ★ 핵심: 카드 자체를 항상 일정 높이로 */
  min-height: 560px;                /* PC 기준 여유 높이 */
  display:flex; flex-direction:column;
}

/* 진행바 */
.progress-wrapper{
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:16px;
}
#progress-bar{
  flex:1; height:14px; background:#334155;
  border-radius:9999px; overflow:hidden; margin-right:12px;
}
#progress-fill{
  height:100%; width:0%;
  background:linear-gradient(90deg, var(--accent-blue), var(--accent-green));
  transition:width .3s ease;
}
#progress-count{ font-size:14px; color:var(--muted); }

/* 문제 문장 – 크고 중앙 */
#stem{
  font-size:30px; font-weight:800; text-align:center; margin:28px 0 20px;
}

/* 보기 – 2열, 일정 높이 확보로 흔들림 방지 */
.choices{
  display:grid; grid-template-columns:1fr 1fr; gap:20px;
  margin-top:12px;

  /* ★ 보기 영역도 최소 높이 */
  min-height: 180px;
}
.choices button{
  background:#334155; border:none; border-radius:12px;
  padding:20px; color:var(--text); text-align:center; cursor:pointer;
  font-size:18px; transition:.2s;
}
.choices button:hover{ background:#475569; }
.choice-correct{ background:#16a34a !important; color:#fff; }
.choice-wrong{ background:#dc2626 !important; color:#fff; }

/* 해설 */
.answer{
  margin-top:18px; font-size:15px; color:var(--muted);

  /* ★ 해설 영역 고정 공간 확보 */
  min-height: 160px;               /* 짧은 해설만 있어도 공간 유지 */
  display:flex; flex-direction:column; justify-content:flex-start;
}
.more{ margin-top:10px; }

/* 🔵 More 버튼 */
.btn-more{
  background: var(--accent-blue);
  color:#fff; border:none;
  padding:10px 14px;
  border-radius:10px;
  font-weight:600; cursor:pointer;
}
.btn-more:hover{ filter:brightness(1.08); }

/* More 본문 – 부드러운 토글 (중복 정의 금지) */
.more-body{
  max-height: 0;
  overflow: hidden;
  transition: max-height .3s ease, padding .3s ease, border-color .3s ease;
  margin-top:10px;
  padding:0 14px;                 /* 접힌 상태 패딩 */
  background:#243447;
  border:1px solid #334155;
  border-radius:10px;
}
.more-body.open{
  max-height: 400px;              /* 넉넉하게 */
  padding:12px 14px;              /* 펼친 상태 패딩 */
}
.more-body ul{ margin:8px 0 0 18px; }

/* 다음 버튼 */
.actions{ margin-top:auto; text-align:right; } /* 카드 하단 정렬 */

/* 반응형 – 모바일에서 높이 살짝 축소 */
@media (max-width: 640px){
  .choices{ grid-template-columns:1fr; min-height: 220px; }
  .card{ min-height: 520px; padding:28px; }
  #stem{ font-size:26px; margin:20px 0 14px; }
  .answer{ min-height: 150px; }
  .more-body.open{ max-height: 360px; }
}

/* 초고해상도에서 약간 키우기 (선택) */
@media (min-width: 1280px){
  .card{ min-height: 580px; }
  #stem{ font-size:32px; }
}
/* ───────────────── 레이아웃 고정: 카드 내부 구조 안정화 ───────────────── */

/* 카드 전체를 세로 플렉스로 만들고, 높이를 충분히 확보 */
.quiz-screen.card{
  display: flex;
  flex-direction: column;
  min-height: 620px;            /* 필요시 580~660 사이에서 조절 */
}

/* 진행바는 고정 영역 */
.quiz-screen .progress-wrapper{
  flex: 0 0 auto;
}

/* 문제 문장(#stem): 고정 최소 높이 + 가운데 정렬 → 줄 길이 달라도 점프 방지 */
#stem{
  flex: 0 0 auto;
  min-height: 110px;            /* 문제 길이에 맞춰 96~130px로 조절 가능 */
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  line-height: 1.35;
}

/* 보기(choices): 스크롤 가능한 고정 구역
   - min/max로 영역을 확보하고, 내용이 넘치면 이 안에서만 스크롤 */
.choices{
  flex: 1 1 auto;               /* 남는 공간을 우선 차지 */
  min-height: 260px;            /* 2x2 그리드 기준 여유 */
  max-height: 320px;            /* 너무 길어지면 내부 스크롤 */
  overflow: auto;
  padding-right: 2px;           /* 스크롤바 겹침 방지 소량 여백 */
}

/* 해설(answer): 별도 고정 구역 + 내부 스크롤
   - More 펼쳐져도 이 박스 안에서만 스크롤 발생 → 전체 레이아웃 안정 */
.answer{
  flex: 0 0 auto;
  min-height: 180px;            /* 해설 한두 문단 기준 */
  max-height: 220px;            /* 길면 이 안에서만 스크롤 */
  overflow: auto;
  padding-right: 2px;
}

/* 다음 버튼(actions): 항상 카드 맨 아래 고정 */
.actions{
  flex: 0 0 auto;
  margin-top: 12px;
}

/* More 본문(이미 전환을 쓰고 있으므로 그대로 유지).
   해설 박스가 스크롤을 담당하므로 펼칠 때 전체 점프 없음 */
.more-body{
  max-height: 0;
  overflow: hidden;
  transition: max-height .3s ease;
  margin-top: 10px;
  padding: 0 14px;
  background:#243447;
  border:1px solid #334155;
  border-radius:10px;
}
.more-body.open{
  max-height: 360px;            /* 내용에 따라 280~420 사이 조절 */
  padding: 12px 14px;
}

/* 보기 버튼 높이/간격이 커서 작은 화면에서 넘칠 수 있으니, 모바일에서 약간 줄이기 */
@media (max-width: 480px){
  .quiz-screen.card{ min-height: 640px; }     /* 모바일은 약간 더 높게 */
  #stem{ min-height: 96px; font-size: 26px; }
  .choices{ min-height: 240px; max-height: 300px; }
  .choices button{ padding: 16px; font-size: 16px; }
  .answer{ min-height: 160px; max-height: 220px; }
}

