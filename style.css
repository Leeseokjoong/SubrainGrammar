:root{
  --bg:#0f172a; --card:#1e293b; --text:#e2e8f0;
  --muted:#94a3b8; --accent-blue:#3b82f6; --accent-green:#22c55e;
  --radius:16px; --shadow:0 6px 16px rgba(0,0,0,.35);
}

body{
  margin:0;
  font-family:"Noto Sans KR", system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Malgun Gothic", Arial, sans-serif;
  background:var(--bg); color:var(--text);
  display:flex; flex-direction:column; min-height:100vh;
}

.topbar{ text-align:center; padding:24px 0; }
.topbar h1{ margin:0; font-size:26px; font-weight:700; }
.topbar .subtitle{ margin:6px 0 0; color:var(--muted); font-size:14px; }

#quiz{ max-width:820px; margin:0 auto; padding:20px; flex:1; }

/* 메뉴/컨트롤 */
.controls, .menu{ text-align:center; margin:20px 0; }
.file-label{
  background:var(--card); padding:12px 20px;
  border-radius:var(--radius); cursor:pointer;
  border:1px solid #334155; font-size:15px;
}
.file-label:hover{ border-color:var(--accent-blue); }
.file-label input{ display:none; }

.start-screen{ text-align:center; margin-top:24px; }

/* 버튼 공통 */
.btn-green, .btn-blue, .btn-ghost, .btn{
  padding:12px 20px; border:none; border-radius:10px;
  font-size:16px; font-weight:600; cursor:pointer; color:#fff;
}
.btn-green{ background:var(--accent-green); }
.btn-blue, .btn{ background:var(--accent-blue); }
.btn-green:hover, .btn-blue:hover, .btn:hover{ filter:brightness(1.1); }
.btn-ghost{
  background:transparent; color:var(--text);
  border:1px solid #3a4a63;
}
.btn-ghost:hover{ border-color:var(--accent-blue); }

/* ───────────────── 카드(퀴즈 화면) 안정 레이아웃 ───────────────── */
.quiz-screen.card{
  background:var(--card); border-radius:var(--radius);
  box-shadow:var(--shadow); padding:40px; margin-top:30px;
  max-width:760px; margin-left:auto; margin-right:auto;

  /* 핵심: 카드 자체는 고정 높이 + 세로 플렉스 */
  display:flex; flex-direction:column;
  min-height:620px;        /* 화면에 맞춰 580~660 사이에서 조정 */
}

/* 진행바 */
.progress-wrapper{
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:16px; flex:0 0 auto;
}
#progress-bar{
  flex:1; height:14px; background:#334155;
  border-radius:9999px; overflow:hidden; margin-right:12px;
}
#progress-fill{
  height:100%; width:0%;
  background:linear-gradient(90deg, var(--accent-blue), var(--accent-green));
  transition:width .3s ease;
}
#progress-count{ font-size:14px; color:var(--muted); }

/* 문제 문장: 두 줄 범위로 고정 + 가운데 정렬 */
#stem{
  flex:0 0 auto;
  min-height:110px;       /* 한 줄 기준 96~130 사이에서 조정 가능 */
  max-height:130px;
  display:flex; align-items:center; justify-content:center;
  text-align:center; line-height:1.35;
  font-size:28px; font-weight:800;
  margin:18px 0 8px;
  overflow-wrap:break-word;  /* 긴 단어 줄바꿈 */
}

/* 보기: 2x2 고정 그리드 + 내부 스크롤(넘치면) */
.choices{
  flex:1 1 auto;                 /* 중앙 영역 확보 */
  display:grid; grid-template-columns:repeat(2,1fr);
  gap:16px; margin-top:12px;
  min-height:260px; max-height:320px;
  overflow:auto;                 /* 길어지면 이 영역만 스크롤 */
  padding-right:2px;             /* 스크롤바 겹침 방지 */
}
.choices button{
  background:#334155; border:none; border-radius:12px;
  height:90px;                   /* 버튼 높이 통일 */
  padding:10px; color:var(--text); cursor:pointer;
  font-size:18px; text-align:center;
  display:flex; align-items:center; justify-content:center;
  white-space:normal; word-break:keep-all;  /* 영어도 단어 단위 줄바꿈 */
  transition:background .2s ease;
}
.choices button:hover{ background:#475569; }
.choice-correct{ background:#16a34a !important; color:#fff; }
.choice-wrong{ background:#dc2626 !important; color:#fff; }

/* 해설: 고정 높이 + 내부 스크롤 */
.answer{
  flex:0 0 auto;
  margin-top:16px; font-size:15px; color:var(--muted);
  min-height:180px; max-height:220px;
  overflow:auto; padding-right:2px;
}

/* More */
.more{ margin-top:10px; }
.btn-more{
  background:var(--accent-blue); color:#fff;
  border:none; padding:10px 14px; border-radius:10px;
  font-weight:600; cursor:pointer;
}
.btn-more:hover{ filter:brightness(1.08); }
.more-body{
  max-height:0; overflow:hidden;
  transition:max-height .3s ease, padding .3s ease, border-color .3s ease;
  margin-top:10px; padding:0 14px;
  background:#243447; border:1px solid #334155; border-radius:10px;
}
.more-body.open{
  max-height:360px; padding:12px 14px;
}
.more-body ul{ margin:8px 0 0 18px; }

/* 다음 버튼: 카드 하단 고정 */
.actions{
  flex:0 0 auto;
  margin-top:12px; text-align:right;
}

/* 반응형 */
@media (max-width: 640px){
  .quiz-screen.card{ min-height:640px; padding:28px; }
  #stem{ font-size:26px; min-height:96px; max-height:120px; }
  .choices{ grid-template-columns:1fr; min-height:240px; max-height:300px; }
  .choices button{ font-size:16px; height:80px; }
  .answer{ min-height:160px; max-height:220px; }
}

@media (min-width: 1280px){
  .quiz-screen.card{ min-height:640px; }
  #stem{ font-size:30px; }
}
/* ======= 컴팩트 원스크린 모드(덮어쓰기) ======= */

/* 카드: 뷰포트 높이에 맞춰 고정(스크롤 없음) */
.quiz-screen.card{
  height: clamp(520px, 78vh, 640px);  /* 화면에 맞춰 자동 조정 */
  min-height: auto;                   /* 이전 값 무시 */
  padding: 24px;                      /* 패딩 축소 */
  gap: 8px;
}

/* 진행바: 높이/여백 컴팩트 */
.quiz-screen .progress-wrapper{ margin-bottom: 8px; }
#progress-bar{ height: 10px; }

/* 문제(#stem): 두 줄까지만 표시 + 가운데 정렬(줄바꿈/말줄임) */
#stem{
  font-size: 26px;
  margin: 8px 0;
  min-height: 72px;
  max-height: 92px;
  line-height: 1.35;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;          /* 두 줄 고정 */
  -webkit-box-orient: vertical;
}

/* 보기(2x2): 고정 높이로 통일, 내부 스크롤 금지 */
.choices{
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  min-height: 200px;
  max-height: 220px;
  overflow: hidden;
  margin-top: 8px;
}
.choices button{
  height: 78px;                    /* 버튼 높이 통일 */
  padding: 10px;
  font-size: 16px;
  white-space: normal;
  word-break: keep-all;
}

/* 해설: 한 화면에 맞게 고정 높이 + 내부 스크롤 */
.answer{
  min-height: 110px;
  max-height: 120px;
  font-size: 14px;
  overflow: auto;
  padding-right: 2px;
}

/* More 본문: 컴팩트 높이 */
.more-body{ transition: max-height .25s ease, padding .25s ease; }
.more-body.open{ max-height: 160px; }

/* 다음 버튼: 카드 하단 고정 */
.actions{ margin-top: auto; }

/* 모바일(≤640px): 세로 1열이지만 여전히 원스크린로 맞춤 */
@media (max-width: 640px){
  .quiz-screen.card{ height: clamp(540px, 84vh, 640px); padding: 20px; }
  #stem{ font-size: 24px; min-height: 64px; max-height: 86px; }
  .choices{ grid-template-columns: 1fr; min-height: 220px; max-height: 240px; }
  .choices button{ height: 70px; font-size: 15px; }
  .answer{ min-height: 110px; max-height: 120px; font-size: 13.5px; }
}

